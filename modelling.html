<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Modelling | Online R Course</title>
  <meta name="description" content="Chapter 9 Modelling | Online R Course" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Modelling | Online R Course" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Modelling | Online R Course" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reshaping-data.html">
<link rel="next" href="simulation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome!</a></li>
<li class="chapter" data-level="2" data-path="setting-up.html"><a href="setting-up.html"><i class="fa fa-check"></i><b>2</b> Setting up</a><ul>
<li class="chapter" data-level="2.1" data-path="setting-up.html"><a href="setting-up.html#about-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> About R and RStudio</a><ul>
<li class="chapter" data-level="2.1.1" data-path="setting-up.html"><a href="setting-up.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.1</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="setting-up.html"><a href="setting-up.html#get-the-data"><i class="fa fa-check"></i><b>2.2</b> Get the data</a></li>
<li class="chapter" data-level="2.3" data-path="setting-up.html"><a href="setting-up.html#navigating-rstudio"><i class="fa fa-check"></i><b>2.3</b> Navigating RStudio</a><ul>
<li class="chapter" data-level="2.3.1" data-path="setting-up.html"><a href="setting-up.html#console"><i class="fa fa-check"></i><b>2.3.1</b> Console</a></li>
<li class="chapter" data-level="2.3.2" data-path="setting-up.html"><a href="setting-up.html#environment"><i class="fa fa-check"></i><b>2.3.2</b> Environment</a></li>
<li class="chapter" data-level="2.3.3" data-path="setting-up.html"><a href="setting-up.html#packages-help"><i class="fa fa-check"></i><b>2.3.3</b> Packages, Help</a></li>
<li class="chapter" data-level="2.3.4" data-path="setting-up.html"><a href="setting-up.html#source"><i class="fa fa-check"></i><b>2.3.4</b> Source</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="setting-up.html"><a href="setting-up.html#r-markdown"><i class="fa fa-check"></i><b>2.4</b> R Markdown</a></li>
<li class="chapter" data-level="2.5" data-path="setting-up.html"><a href="setting-up.html#comments"><i class="fa fa-check"></i><b>2.5</b> Comments</a></li>
<li class="chapter" data-level="2.6" data-path="setting-up.html"><a href="setting-up.html#getting-the-files"><i class="fa fa-check"></i><b>2.6</b> Getting the files</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="base-r.html"><a href="base-r.html"><i class="fa fa-check"></i><b>3</b> Base-R</a><ul>
<li class="chapter" data-level="3.1" data-path="base-r.html"><a href="base-r.html#objects-and-functions"><i class="fa fa-check"></i><b>3.1</b> Objects and functions</a><ul>
<li class="chapter" data-level="3.1.1" data-path="base-r.html"><a href="base-r.html#naming-objects"><i class="fa fa-check"></i><b>3.1.1</b> Naming objects</a></li>
<li class="chapter" data-level="3.1.2" data-path="base-r.html"><a href="base-r.html#errors"><i class="fa fa-check"></i><b>3.1.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="base-r.html"><a href="base-r.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a><ul>
<li class="chapter" data-level="3.2.1" data-path="base-r.html"><a href="base-r.html#help"><i class="fa fa-check"></i><b>3.2.1</b> Help</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="base-r.html"><a href="base-r.html#packages"><i class="fa fa-check"></i><b>3.3</b> Packages</a></li>
<li class="chapter" data-level="3.4" data-path="base-r.html"><a href="base-r.html#quotation-marks"><i class="fa fa-check"></i><b>3.4</b> Quotation Marks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>4</b> Graphics with ggplot2</a><ul>
<li class="chapter" data-level="4.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#welcome-to-ggplot"><i class="fa fa-check"></i><b>4.1</b> Welcome to ggplot</a></li>
<li class="chapter" data-level="4.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#ggplot2_setting_up"><i class="fa fa-check"></i><b>4.2</b> Setting up</a></li>
<li class="chapter" data-level="4.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#description-of-the-pulse-of-the-nation-dataset"><i class="fa fa-check"></i><b>4.3</b> Description of the “Pulse of the Nation” Dataset</a></li>
<li class="chapter" data-level="4.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#main-components-of-ggplot2"><i class="fa fa-check"></i><b>4.4</b> Main components of ggplot2</a></li>
<li class="chapter" data-level="4.5" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#first-ggplot2-graph"><i class="fa fa-check"></i><b>4.5</b> First ggplot2 graph</a></li>
<li class="chapter" data-level="4.6" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-colour"><i class="fa fa-check"></i><b>4.6</b> Adding colour</a></li>
<li class="chapter" data-level="4.7" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#more-geoms"><i class="fa fa-check"></i><b>4.7</b> More Geoms</a></li>
<li class="chapter" data-level="4.8" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#scales"><i class="fa fa-check"></i><b>4.8</b> Scales</a></li>
<li class="chapter" data-level="4.9" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#layering"><i class="fa fa-check"></i><b>4.9</b> Layering</a></li>
<li class="chapter" data-level="4.10" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#more-geoms-1"><i class="fa fa-check"></i><b>4.10</b> More geoms</a></li>
<li class="chapter" data-level="4.11" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#comparing-attractiveness-across-gender"><i class="fa fa-check"></i><b>4.11</b> Comparing attractiveness across gender</a></li>
<li class="chapter" data-level="4.12" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#splitting-plots-using-facets"><i class="fa fa-check"></i><b>4.12</b> Splitting plots using Facets</a></li>
<li class="chapter" data-level="4.13" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#themes-and-labels"><i class="fa fa-check"></i><b>4.13</b> Themes and labels</a></li>
<li class="chapter" data-level="4.14" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#recap-exercises"><i class="fa fa-check"></i><b>4.14</b> Recap Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation with dplyr</a><ul>
<li class="chapter" data-level="5.1" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#set-up-for-session"><i class="fa fa-check"></i><b>5.1</b> Set Up for Session</a></li>
<li class="chapter" data-level="5.2" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#description-of-datasets-being-used"><i class="fa fa-check"></i><b>5.2</b> Description of Datasets Being Used</a></li>
<li class="chapter" data-level="5.3" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#slicing-filter-and-select"><i class="fa fa-check"></i><b>5.3</b> Slicing, Filter and Select</a></li>
<li class="chapter" data-level="5.4" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#creating-new-dataframe"><i class="fa fa-check"></i><b>5.4</b> Creating new dataframe</a></li>
<li class="chapter" data-level="5.5" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#column-transformations"><i class="fa fa-check"></i><b>5.5</b> Column Transformations</a></li>
<li class="chapter" data-level="5.6" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#more-ways-to-filter"><i class="fa fa-check"></i><b>5.6</b> More ways to filter</a></li>
<li class="chapter" data-level="5.7" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#aggregationgrouping"><i class="fa fa-check"></i><b>5.7</b> Aggregation/Grouping</a></li>
<li class="chapter" data-level="5.8" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#pipes"><i class="fa fa-check"></i><b>5.8</b> Pipes</a></li>
<li class="chapter" data-level="5.9" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#the-summarise-function"><i class="fa fa-check"></i><b>5.9</b> The summarise() function</a></li>
<li class="chapter" data-level="5.10" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#arranging"><i class="fa fa-check"></i><b>5.10</b> Arranging</a></li>
<li class="chapter" data-level="5.11" data-path="data-manipulation-with-dplyr.html"><a href="data-manipulation-with-dplyr.html#summary"><i class="fa fa-check"></i><b>5.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>6</b> Importing Data</a><ul>
<li class="chapter" data-level="6.1" data-path="importing-data.html"><a href="importing-data.html#placeholder"><i class="fa fa-check"></i><b>6.1</b> Placeholder</a></li>
<li class="chapter" data-level="6.2" data-path="importing-data.html"><a href="importing-data.html#introduction-to-ukireland-dataset"><i class="fa fa-check"></i><b>6.2</b> Introduction to UKIreland dataset</a></li>
<li class="chapter" data-level="6.3" data-path="importing-data.html"><a href="importing-data.html#reading-in-data-from-csv"><i class="fa fa-check"></i><b>6.3</b> Reading in data from CSV</a></li>
<li class="chapter" data-level="6.4" data-path="importing-data.html"><a href="importing-data.html#reading-in-from-excel"><i class="fa fa-check"></i><b>6.4</b> Reading in from Excel</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="merging-datasets.html"><a href="merging-datasets.html"><i class="fa fa-check"></i><b>7</b> Merging datasets</a><ul>
<li class="chapter" data-level="7.1" data-path="merging-datasets.html"><a href="merging-datasets.html#set-up-for-session-1"><i class="fa fa-check"></i><b>7.1</b> Set Up for Session</a></li>
<li class="chapter" data-level="7.2" data-path="merging-datasets.html"><a href="merging-datasets.html#binding"><i class="fa fa-check"></i><b>7.2</b> Binding</a></li>
<li class="chapter" data-level="7.3" data-path="merging-datasets.html"><a href="merging-datasets.html#introducing-merging"><i class="fa fa-check"></i><b>7.3</b> Introducing merging</a></li>
<li class="chapter" data-level="7.4" data-path="merging-datasets.html"><a href="merging-datasets.html#applying-merging"><i class="fa fa-check"></i><b>7.4</b> Applying merging</a><ul>
<li class="chapter" data-level="7.4.1" data-path="merging-datasets.html"><a href="merging-datasets.html#piping-into-ggplot-some-new-geoms"><i class="fa fa-check"></i><b>7.4.1</b> Piping into ggplot (+ some new geoms)</a></li>
<li class="chapter" data-level="7.4.2" data-path="merging-datasets.html"><a href="merging-datasets.html#challenging-merging"><i class="fa fa-check"></i><b>7.4.2</b> Challenging Merging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reshaping-data.html"><a href="reshaping-data.html"><i class="fa fa-check"></i><b>8</b> Reshaping Data</a><ul>
<li class="chapter" data-level="8.1" data-path="reshaping-data.html"><a href="reshaping-data.html#going-long"><i class="fa fa-check"></i><b>8.1</b> Going Long</a></li>
<li class="chapter" data-level="8.2" data-path="reshaping-data.html"><a href="reshaping-data.html#going-wide"><i class="fa fa-check"></i><b>8.2</b> Going wide</a><ul>
<li class="chapter" data-level="8.2.1" data-path="reshaping-data.html"><a href="reshaping-data.html#exercises"><i class="fa fa-check"></i><b>8.2.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>9</b> Modelling</a><ul>
<li class="chapter" data-level="9.1" data-path="modelling.html"><a href="modelling.html#set-up-for-session-2"><i class="fa fa-check"></i><b>9.1</b> Set Up for Session</a></li>
<li class="chapter" data-level="9.2" data-path="modelling.html"><a href="modelling.html#exploring-data"><i class="fa fa-check"></i><b>9.2</b> Exploring Data</a></li>
<li class="chapter" data-level="9.3" data-path="modelling.html"><a href="modelling.html#fitting-model"><i class="fa fa-check"></i><b>9.3</b> Fitting Model</a></li>
<li class="chapter" data-level="9.4" data-path="modelling.html"><a href="modelling.html#checking-model"><i class="fa fa-check"></i><b>9.4</b> Checking Model</a></li>
<li class="chapter" data-level="9.5" data-path="modelling.html"><a href="modelling.html#updating-model"><i class="fa fa-check"></i><b>9.5</b> Updating Model</a></li>
<li class="chapter" data-level="9.6" data-path="modelling.html"><a href="modelling.html#confidence-and-prediction-intervals"><i class="fa fa-check"></i><b>9.6</b> Confidence and Prediction Intervals</a></li>
<li class="chapter" data-level="9.7" data-path="modelling.html"><a href="modelling.html#extending-to-multiple-regression"><i class="fa fa-check"></i><b>9.7</b> Extending to multiple regression:</a></li>
<li class="chapter" data-level="9.8" data-path="modelling.html"><a href="modelling.html#exercise"><i class="fa fa-check"></i><b>9.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>10</b> Simulation</a><ul>
<li class="chapter" data-level="10.1" data-path="simulation.html"><a href="simulation.html#description-of-the-session-goal"><i class="fa fa-check"></i><b>10.1</b> Description of the session goal</a></li>
<li class="chapter" data-level="10.2" data-path="simulation.html"><a href="simulation.html#find-and-install-r-packages"><i class="fa fa-check"></i><b>10.2</b> Find and install R packages</a></li>
<li class="chapter" data-level="10.3" data-path="simulation.html"><a href="simulation.html#sampling-from-data-or-known-distributions"><i class="fa fa-check"></i><b>10.3</b> Sampling from data or known distributions</a></li>
<li class="chapter" data-level="10.4" data-path="simulation.html"><a href="simulation.html#sampling-from-data"><i class="fa fa-check"></i><b>10.4</b> Sampling from data</a></li>
<li class="chapter" data-level="10.5" data-path="simulation.html"><a href="simulation.html#generating-random-numbers-from-distributions"><i class="fa fa-check"></i><b>10.5</b> Generating random numbers from distributions</a></li>
<li class="chapter" data-level="10.6" data-path="simulation.html"><a href="simulation.html#reproducing-samples"><i class="fa fa-check"></i><b>10.6</b> Reproducing samples</a></li>
<li class="chapter" data-level="10.7" data-path="simulation.html"><a href="simulation.html#sampling-from-data-1"><i class="fa fa-check"></i><b>10.7</b> Sampling from data</a></li>
<li class="chapter" data-level="10.8" data-path="simulation.html"><a href="simulation.html#making-functions"><i class="fa fa-check"></i><b>10.8</b> Making functions</a></li>
<li class="chapter" data-level="10.9" data-path="simulation.html"><a href="simulation.html#when-to-write-your-own-functions"><i class="fa fa-check"></i><b>10.9</b> When to write your own functions</a></li>
<li class="chapter" data-level="10.10" data-path="simulation.html"><a href="simulation.html#iterations-loops"><i class="fa fa-check"></i><b>10.10</b> Iterations (loops)</a></li>
<li class="chapter" data-level="10.11" data-path="simulation.html"><a href="simulation.html#puttng-it-all-together"><i class="fa fa-check"></i><b>10.11</b> Puttng it all together</a></li>
<li class="chapter" data-level="10.12" data-path="simulation.html"><a href="simulation.html#simulation-of-the-best-strategy"><i class="fa fa-check"></i><b>10.12</b> Simulation of the best strategy</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://stats4sd.org/" target="blank">By Statistics for Sustianable Development</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Online R Course</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Modelling</h1>
<div id="set-up-for-session-2" class="section level2">
<h2><span class="header-section-number">9.1</span> Set Up for Session</h2>
<p>Packages used = ggplot2, ciTools, dplyr, ggfortify
Data used: eastbournedata.csv</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ciTools)</code></pre>
<pre><code>## ciTools version 0.5.1 (C) Institute for Defense Analyses</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggfortify)

eastbourne&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;C:/Users/FaheemAshraf/Dropbox (SSD)/Faheem_workings/2018-11-22 - R Course Editing/Book version files/Data/eastbournedata.csv&quot;</span>)</code></pre>
</div>
<div id="exploring-data" class="section level2">
<h2><span class="header-section-number">9.2</span> Exploring Data</h2>
<p>The data for this example is taken from the UK Met office and contains the average daily maximum temperatures, minimum temperatures and rainfall for all years since 1959.</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1&lt;-<span class="kw">ggplot</span>(<span class="dt">data=</span>eastbourne,<span class="kw">aes</span>(<span class="dt">y=</span>tmax,<span class="dt">x=</span>yyyy))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()
plot1</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
<p>What would be our initial thoughts about the relationship between temperature and time in Eastbourne?</p>
<p><code>geom_smooth</code> is a nice way to add on simple models to your plot that we have seen before.</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1 <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<p>The default model fitted by geom_smooth depends on the amount of data being plotted. In this case it has told us that it is using a “loess” model to fit the line - this is a simple form of a moving average smoother. It can be useful for visualising trends that do not fit into other models, but they cannot be used for extensive statistical inference.</p>
<p>Lets use a more familiar model by changing the “method” option into a simple linear regression:</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1 <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
<div id="fitting-model" class="section level2">
<h2><span class="header-section-number">9.3</span> Fitting Model</h2>
<p>To examine what we actually have in our model we need to fit the model using the lm() command:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(tmax<span class="op">~</span>yyyy,<span class="dt">data=</span>eastbourne)</code></pre>
<pre><code>## 
## Call:
## lm(formula = tmax ~ yyyy, data = eastbourne)
## 
## Coefficients:
## (Intercept)         yyyy  
##   -58.58684      0.03645</code></pre>
<p>The output by default only tells us two things:
“Call” - simply repeating back the model we have specified
“Coefficients”: Telling us the values of the parameters</p>
<p>A linear regression follows the equation of a straight line y = B0 + B1x (or y=a+bx or y=mx+c ; depending on where and when you were 12 years old)
The coefficients give us the value of our intercept: -58.6 and the value of our slope: 0.036. So the overall model would be:</p>
<p>tmax = -58.6 + 0.036*yyyy</p>
<p>This means if yyyy=0 we would expect the maximum temperature in that year to be -58.6 degrees (!!!) and for every one year increase the average temperature increase is 0.036 degrees.</p>
<p>To get more output then we need to save the model to an object:</p>
<pre class="sourceCode r"><code class="sourceCode r">tmaxmodel&lt;-<span class="kw">lm</span>(tmax<span class="op">~</span>yyyy,<span class="dt">data=</span>eastbourne)</code></pre>
<p>Then there are lots of functions that give us different pieces of output and inference from this model.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(tmaxmodel)</code></pre>
<pre><code>## 
## Call:
## lm(formula = tmax ~ yyyy, data = eastbourne)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.3691 -0.3777  0.0604  0.3211  1.7267 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -58.586839   9.724527  -6.025 1.39e-07 ***
## yyyy          0.036448   0.004893   7.450 6.25e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6238 on 56 degrees of freedom
## Multiple R-squared:  0.4977, Adjusted R-squared:  0.4888 
## F-statistic:  55.5 on 1 and 56 DF,  p-value: 6.255e-10</code></pre>
<p>summary(model) provides us with a lot of useful information - model fit statistics (R squared values &amp; F statistic), standard errors and p-values for the coefficients.</p>
<p>One thing missing is confidence intervals, this comes from confint:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(tmaxmodel)</code></pre>
<pre><code>##                    2.5 %       97.5 %
## (Intercept) -78.06740617 -39.10627121
## yyyy          0.02664692   0.04624931</code></pre>
</div>
<div id="checking-model" class="section level2">
<h2><span class="header-section-number">9.4</span> Checking Model</h2>
<p>We should also check our model fit plots to assess model validity.
<code>autoplot(model)</code> from the ggfortify package produces 4 model checking plots. When we are working with time series data it is also very useful to produce an extra plot - the acf (auto-correlation plot) to assess the strength of temporal correlation.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(tmaxmodel)</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<p>Do these plots look OK? What are we actually looking for here?</p>
<p>In particular we can see a problem with the trend in the residual vs fitted plot as there is clear curvature in the pattern. Does this make sense if we go back to our original scatter plots and the loess models fitted by geom_smooth</p>
</div>
<div id="updating-model" class="section level2">
<h2><span class="header-section-number">9.5</span> Updating Model</h2>
<p>One solution to solve the problem we have might be to fit a model only on the years between 1975 to 2015, since the trend during this range appears to be relatively linear. We can filter our data and then pipe through to lm:</p>
<pre class="sourceCode r"><code class="sourceCode r">eastbourne <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(yyyy<span class="op">&gt;=</span><span class="dv">1975</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y=</span>tmax,<span class="dt">x=</span>yyyy))<span class="op">+</span>
<span class="st">     </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">       </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">eastbourne <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(yyyy<span class="op">&gt;=</span><span class="dv">1975</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">lm</span>(tmax<span class="op">~</span>yyyy,<span class="dt">data=</span>.)</code></pre>
<pre><code>## 
## Call:
## lm(formula = tmax ~ yyyy, data = .)
## 
## Coefficients:
## (Intercept)         yyyy  
##   -77.97949      0.04615</code></pre>
<p>This is slightly different to what we have seen previously with pipes because the first argument of lm() is the formula and not the data. Using the pipe automatically puts the data into the first argument of the next line. For lm(), and other functions where data is not the first argument, then saying “data=.” tells R where to put the data from the previous line.</p>
<p>Again we need to assign this to an object to do other useful things! Let’s first check the model validity plots to see if they look any better:</p>
<pre class="sourceCode r"><code class="sourceCode r">tmaxmodel_<span class="dv">1975</span>&lt;-
<span class="st">  </span>eastbourne <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(yyyy<span class="op">&gt;=</span><span class="dv">1975</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">lm</span>(tmax<span class="op">~</span>yyyy,<span class="dt">data=</span>.)

<span class="kw">autoplot</span>(tmaxmodel_<span class="dv">1975</span>)</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>This looks better. Let’s take another look at these result:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(tmaxmodel_<span class="dv">1975</span>)</code></pre>
<pre><code>## 
## Call:
## lm(formula = tmax ~ yyyy, data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.20748 -0.30145  0.04414  0.35503  1.08659 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -77.979495  14.810825  -5.265 5.07e-06 ***
## yyyy          0.046146   0.007422   6.217 2.34e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.583 on 40 degrees of freedom
## Multiple R-squared:  0.4915, Adjusted R-squared:  0.4788 
## F-statistic: 38.66 on 1 and 40 DF,  p-value: 2.337e-07</code></pre>
</div>
<div id="confidence-and-prediction-intervals" class="section level2">
<h2><span class="header-section-number">9.6</span> Confidence and Prediction Intervals</h2>
<p>The geom_smooth function fits confidence intervals around the line. This tells us the margin of error in the expected value of temperature in each year.
This is OK, but it can also be very useful to include prediction intervals. This tells us the range where we would expect any individual observation to be.</p>
<p>The functions add_ci and add_pi can add in confidence intervals and prediction intervals to our original data. These work nicely in pipes, where we simply need the name of the model inside these functions.</p>
<pre class="sourceCode r"><code class="sourceCode r">eastbourne_int&lt;-eastbourne <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(yyyy<span class="op">&gt;=</span><span class="dv">1975</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">add_pi</span>(tmaxmodel_<span class="dv">1975</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">add_ci</span>(tmaxmodel_<span class="dv">1975</span>)</code></pre>
<p>To add in errors as lines this needs the <code>geom_ribbon</code> geom from ggplot2.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(eastbourne_int,<span class="kw">aes</span>(<span class="dt">x=</span>yyyy,<span class="dt">y=</span>tmax))<span class="op">+</span>
<span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)<span class="op">+</span>
<span class="st">   </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymax=</span>UPB0<span class="fl">.975</span>,<span class="dt">ymin=</span> LPB0<span class="fl">.025</span>)) </code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p><strong>QUESTION - This graph is ‘correct’, but looks horrible. Can you find the options to make this plot look a bit better? Instead of a big black blob, how can we have something more similar to the way the error bar gets plotted in geom_smooth() - transparent and shaded in a colour rather than black?</strong></p>
<p>We can also use add_ci or add_pi to give us future predictions to extrapolate our model into the future</p>
<pre class="sourceCode r"><code class="sourceCode r">predictiondata&lt;-<span class="kw">data.frame</span>(<span class="dt">yyyy=</span><span class="dv">1975</span><span class="op">:</span><span class="dv">2100</span>) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">add_ci</span>(tmaxmodel_<span class="dv">1975</span>) <span class="op">%&gt;%</span>
<span class="st">     </span><span class="kw">add_pi</span>(tmaxmodel_<span class="dv">1975</span>) 
predictiondata</code></pre>
<pre><code>## # A tibble: 126 x 6
##     yyyy  pred LCB0.025 UCB0.975 LPB0.025 UPB0.975
##    &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1  1975  13.2     12.8     13.5     11.9     14.4
##  2  1976  13.2     12.9     13.5     12.0     14.4
##  3  1977  13.3     12.9     13.6     12.0     14.5
##  4  1978  13.3     13.0     13.6     12.1     14.5
##  5  1979  13.3     13.0     13.7     12.1     14.6
##  6  1980  13.4     13.1     13.7     12.2     14.6
##  7  1981  13.4     13.2     13.7     12.2     14.6
##  8  1982  13.5     13.2     13.8     12.3     14.7
##  9  1983  13.5     13.3     13.8     12.3     14.7
## 10  1984  13.6     13.3     13.8     12.4     14.8
## # ... with 116 more rows</code></pre>
<p>We can plot our predicted model into the future onto a nice graph as well. But - we have our raw data in one file and our predicted data in another file. So we are going to show you how to use ggplot to make a single plot from multple data frames.</p>
<p>Using plot1 (saved earlier) - which had used the data=eastbourne.</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<p>We can add in the aesthetics and data into any geom. But we need to add in also an option inherit.aes=FALSE. This tells R to ignore the ‘global’ aesthetics which were set in the original ggplot() statement.</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yyyy,<span class="dt">y=</span>pred),<span class="dt">data=</span>predictiondata,<span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) </code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<p>We can then add our prediction interval in the same way:</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yyyy,<span class="dt">y=</span>pred),<span class="dt">data=</span>predictiondata,<span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yyyy,<span class="dt">ymax=</span>UPB0<span class="fl">.975</span>,<span class="dt">ymin=</span>LPB0<span class="fl">.025</span>),<span class="dt">data=</span>predictiondata,<span class="dt">alpha=</span><span class="fl">0.2</span>,<span class="dt">fill=</span><span class="st">&quot;red&quot;</span>,<span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Online_R_Course_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
<div id="extending-to-multiple-regression" class="section level2">
<h2><span class="header-section-number">9.7</span> Extending to multiple regression:</h2>
<p>We can add variables into our model using +. Let’s add rainfall as a potential predictor for tmax.</p>
<pre class="sourceCode r"><code class="sourceCode r">tmaxrain&lt;-<span class="kw">lm</span>(tmax<span class="op">~</span>yyyy<span class="op">+</span>rain,<span class="dt">data=</span>eastbourne)
<span class="kw">summary</span>(tmaxrain)</code></pre>
<pre><code>## 
## Call:
## lm(formula = tmax ~ yyyy + rain, data = eastbourne)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.36728 -0.37668  0.06186  0.31932  1.72483 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -5.850e+01  9.889e+00  -5.916 2.20e-07 ***
## yyyy         3.642e-02  4.950e-03   7.359 9.74e-10 ***
## rain        -5.395e-04  7.796e-03  -0.069    0.945    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6294 on 55 degrees of freedom
## Multiple R-squared:  0.4978, Adjusted R-squared:  0.4795 
## F-statistic: 27.26 on 2 and 55 DF,  p-value: 5.95e-09</code></pre>
<p>It looks like there is no evidence of a relationship between rainfall and maximum temperatures.</p>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">9.8</span> Exercise</h2>
<p>Repeat the whole modelling process for the column tmin instead of tmax. Start by making a scatter plot, using geom_smooth to fit a linear model onto this graph and then use lm() to fit a model, check the validity, draw conclusions about how tmin has changed over time, if so by how much, and make predictions for the next 5 years</p>
<ul>
<li>Start with producing a scatter plot, using geom_smooth to fit lines, using booth the smoother and the linear regression</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>eastbourne,<span class="kw">aes</span>(<span class="dt">y=</span>??,<span class="dt">x=</span>???))<span class="op">+</span>???</code></pre>
<ul>
<li><p>Then fit a model of minimum temperature against year:</p></li>
<li><p>Then check the model validity:</p></li>
<li><p>Then look at and interpret the summary table:</p></li>
<li><p>Then make a plot showing the fitted model, and add some prediction intervals around your model:</p></li>
<li><p>(Difficult question) Make a plot showing both tmin and tmax on the same axes and the fitted models for both.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reshaping-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Online_R_Course.pdf", "Online_R_Course.epub"],
"toc": {
"collapse": "subsection",
"download": ["pdf", "epub"]
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
